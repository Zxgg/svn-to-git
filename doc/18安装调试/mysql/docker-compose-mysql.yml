##
## -------------------------
## |  D E V I L S T A C K  |
## -------------------------
##
## Local LAMP/LEMP stack
##
##
## ${VARIABLE:-default} will evaluate to default if VARIABLE is unset or empty in the environment.
## ${VARIABLE-default}  will evaluate to default only if VARIABLE is unset in the environment.
##
##
## -- DO NOT EDIT THIS FILE --
##
## Copy 'docker-compose.override.yml-example' to 'docker-compose.override.yml'
## and edit this file with your custom changes (override or even new services).
##
## Edit '.env' for configuration.
##
## If '.env' does not exist, copy 'env-example' to '.env'
##   $ cp env-example .env
##


version: '2.1'


################################################################################
# SERVICES
################################################################################
services:

  # ------------------------------------------------------------
  # MySQL Database
  # ------------------------------------------------------------
  mysql:
    image: cytopia/mariadb-10.1:latest
    hostname: mysql

    environment:

      ##
      ## Debug?
      ##
      - DEBUG_COMPOSE_ENTRYPOINT=1

      ##
      ## Adjust timezone
      ##
      - TIMEZONE=Europe/Berlin

      ##
      ## Adjust Root password
      ##
      - MYSQL_ROOT_PASSWORD=q123456.

      ##
      ## Socket directory Path
      ##
      - MYSQL_SOCKET_DIR=/tmp/mysql

      ##
      ## Runtime settings
      ##
      - MYSQL_GENERAL_LOG=0

    ports:
      # [local-machine:]local-port:docker-port
      - "3366:3306"


    volumes:
      # ---- Format: ----
      # HOST-DIRECTORY : DOCKER-DIRECTORY
      
      # Synchronize system time
      - /etc/localtime:/etc/localtime:ro
      # Mount logs
      - ./log/mariadb-10.1:/var/log/mysql:rw

      # Mount devilbox default overwrites
      - ./mysql.cnf:/etc/my.cnf:ro

      # Mount devilbox user-defined cnf files in order
      # to overwrite the MySQL server configuration
      #- ./cfg/mariadb-10.1:/etc/mysql/docker-default.d:ro

      # Mount MySQL Data directory
      - ./data/mysql/mariadb-10.1:/var/lib/mysql:rw
